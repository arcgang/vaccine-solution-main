{"version":3,"sources":["webpack:///./src/pages/solution/reefer-iot/index.mdx"],"names":["_frontmatter","makeShortcode","name","props","console","warn","PageDescription","AnchorLinks","AnchorLink","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","mdxType","parentName","isMDXComponent"],"mappings":"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","file":"component---src-pages-solution-reefer-iot-index-mdx-134353238931c7af7dc5.js","sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\n\nimport DefaultLayout from \"/home/runner/work/vaccine-solution-main/vaccine-solution-main/docs/node_modules/gatsby-theme-carbon/src/templates/Default.js\";\nexport const _frontmatter = {};\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\n\nconst PageDescription = makeShortcode(\"PageDescription\");\nconst AnchorLinks = makeShortcode(\"AnchorLinks\");\nconst AnchorLink = makeShortcode(\"AnchorLink\");\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <PageDescription mdxType=\"PageDescription\">\nThis Simulator web application is a simple python (3.7) Flask app, exposing a REST POST end point to control the type of simulation we want to run and to produce refrigerator container telemetry events to kafka `telemetries` topic.\n    </PageDescription>\n    <p>{`Updated on 3/21/2021, a new user interface was added to present the simulation and connect to the Freezer manager microservice to get server side event. `}</p>\n    <AnchorLinks mdxType=\"AnchorLinks\">\n  <AnchorLink mdxType=\"AnchorLink\">Overview</AnchorLink>\n  <AnchorLink mdxType=\"AnchorLink\">Anatomy</AnchorLink>\n  <AnchorLink mdxType=\"AnchorLink\">Build</AnchorLink>\n  <AnchorLink mdxType=\"AnchorLink\">Run</AnchorLink>\n  <AnchorLink mdxType=\"AnchorLink\">Demonstrate</AnchorLink>\n    </AnchorLinks>\n    <h2>{`Overview`}</h2>\n    <p>{`This refrigerator simulator implementation illustrates the following technologies:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`Flask, with blueprint, flasgger.Swagger, prometheus metrics`}</li>\n      <li parentName=\"ul\">{`Kafka producer code using Confuent-python library`}</li>\n      <li parentName=\"ul\">{`Integration with Health for kubernetes deployment`}</li>\n      <li parentName=\"ul\">{`Sensor simulator using numpy, Pandas to generate tuples and simulated data`}</li>\n      <li parentName=\"ul\">{`Use of gnunicorn for serving the webapp in production`}</li>\n      <li parentName=\"ul\">{`Vuejs application connect to Server Side End point from another service`}</li>\n      <li parentName=\"ul\">{`Dynamic end point URL injection to the Vuejs via a REST end point (see `}<inlineCode parentName=\"li\">{`api/freezerURL.py`}</inlineCode>{`)`}</li>\n      <li parentName=\"ul\">{`Vuejs and gauge implemented with`}</li>\n      <li parentName=\"ul\">{`Docker-compose to run locally`}</li>\n      <li parentName=\"ul\">{`Use gitops and Kustomize for deployment. This is declared in a separate `}<a parentName=\"li\" {...{\n          \"href\": \"https://github.com/ibm-cloud-architecture/vaccine-gitops\"\n        }}>{`gitops repository`}</a>{` under `}<inlineCode parentName=\"li\">{`apps`}</inlineCode>{` folder.`}</li>\n    </ul>\n    <p>{`The user interface is intuitive and presents a form to select the container, product, number of record to generate and the type of simulation:`}</p>\n    <span {...{\n      \"className\": \"gatsby-resp-image-wrapper\",\n      \"style\": {\n        \"position\": \"relative\",\n        \"display\": \"block\",\n        \"marginLeft\": \"auto\",\n        \"marginRight\": \"auto\",\n        \"maxWidth\": \"1152px\"\n      }\n    }}>{`\n      `}<span parentName=\"span\" {...{\n        \"className\": \"gatsby-resp-image-background-image\",\n        \"style\": {\n          \"paddingBottom\": \"57.638888888888886%\",\n          \"position\": \"relative\",\n          \"bottom\": \"0\",\n          \"left\": \"0\",\n          \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAABlUlEQVQoz52SS07DMBCGc9SqTdpdWy4A4hYgDsENYMlr1QWCHa8WiYQkdhPHsdPkZ8ZJKh5dACP9monl+fzPKN50OsVsNsN4MsFwNMJgMMBwOITv+/CDAMF4goDr7ptz4AcYd/V3eUmS4O7uHs9PjyiKAuv1GmVZgqOpKugwRI02mqZxWdUWqS2wK7zL6xvsHxzi5PgIZ+fnDqYIbK2F1Romy1pJCUvnudEQRiHWGTKqM6vbh0icvavrK8znezg5OsZisXAuHZBhBDF5jqrUqIzBZrOBNiVMZZ20NSgpNx3MATU1L1dLrMJXGGqSBGGXujTUVLWj4vfhSSGR5AIP8gWCYP0OlSqceJSKwCU5rmgN/Civg88+O9s6DGnpaZIil5mDCSEckBsz2h2PyeI6p/H5DotXw4C6rr9kL01TBxFSuIv9yAxkQA9USjkxmNUDfzjk30Z2ozqHVGsaj8faBeQzFt/Z6TCO49ahYIcSBe2TL/f/3V/lRVG0BSapxO0D76cH4s+xdZjE73iLUpxe0Fjq/w4/AB5Gf2lyVb+FAAAAAElFTkSuQmCC')\",\n          \"backgroundSize\": \"cover\",\n          \"display\": \"block\"\n        }\n      }}></span>{`\n  `}<img parentName=\"span\" {...{\n        \"className\": \"gatsby-resp-image-image\",\n        \"alt\": \"simulator\",\n        \"title\": \"simulator\",\n        \"src\": \"/vaccine-solution-main/static/2642b847faa0c388fd9b828dc0ce16d3/3cbba/simulator.png\",\n        \"srcSet\": [\"/vaccine-solution-main/static/2642b847faa0c388fd9b828dc0ce16d3/7fc1e/simulator.png 288w\", \"/vaccine-solution-main/static/2642b847faa0c388fd9b828dc0ce16d3/a5df1/simulator.png 576w\", \"/vaccine-solution-main/static/2642b847faa0c388fd9b828dc0ce16d3/3cbba/simulator.png 1152w\", \"/vaccine-solution-main/static/2642b847faa0c388fd9b828dc0ce16d3/d43b5/simulator.png 1433w\"],\n        \"sizes\": \"(max-width: 1152px) 100vw, 1152px\",\n        \"style\": {\n          \"width\": \"100%\",\n          \"height\": \"100%\",\n          \"margin\": \"0\",\n          \"verticalAlign\": \"middle\",\n          \"position\": \"absolute\",\n          \"top\": \"0\",\n          \"left\": \"0\"\n        },\n        \"loading\": \"lazy\"\n      }}></img>{`\n    `}</span>\n    <p>{`The right side presents the temperature and co2 gauges and the potential Alerts created by the monitoring agent.`}</p>\n    <h3>{`Application requirements`}</h3>\n    <p>{`The simulator is here to help us develop the other components of the solution as we do not have real life Refrigerator container. The supported features:`}</p>\n    <ol>\n      <li parentName=\"ol\">{`Run the simulator as command line to generate csv file with telemetry data to be shared with Data Scientists.`}</li>\n      <li parentName=\"ol\">{`Support the following simulation: normal behavior, co2 sensor, o2 sensor, temperature and power sensor strange behavior, and continue temperature growth up to ambiant temperature. `}</li>\n      <li parentName=\"ol\">{`Send telemetries to a Kafka topic`}</li>\n      <li parentName=\"ol\">{`Support a user interface to make the demonstration of the end to end solution`}</li>\n    </ol>\n    <p>{`The following figure illustrates the components involved with this simulator.`}</p>\n    <p>{` `}<span parentName=\"p\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"1152px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"55.90277777777778%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB70lEQVQoz5VSzW7TQBjMCyHxDlx5AA48QI88BwKpnLhwBqlwhEOLKqoGorZJK1FKmqSliZM4zY/d1ont3bXXO8yuLaoiBOKzR+tdfzvffLNbi1YS9d0+9veGhIfdnT7smo0ChsB/wKAmbyJ4vRG+t4YOg84IarUClEAhUgcjxb9h8/IMtXh+hYPGCK3GGM0vY+zVPcTLlOU03xymGv8Km5MpR1qbeXO8eNbAuzfH2Hj9FetPP2M2XbqWhVTQTDb8NrgNcwemHG0elbqWe2dTnJ6Mcdr20etOIFXmNoZhiDiJHalSEoIKUiGQsbU7oMpcqZLQyvw9TPVoXSDXrGwKDKdz1FvHmAWhm+csoisUnCtZel4zaQLFTfNFiNkiYEX6Zm4JlVXL+VHHw9udQ+YW+FPk7KAkFIlbSIVEIuQvjbaqJbUKNVsaTANsN79h6PsIr0IExCIMnAWaBZWoFGp6lMgMG5tHDlGclmQVNHET079Mk+AanbMLdM/76P7oo909R3C9xEooRMukJPQGE9x/vI4Hay/x8Mkr3Hv0HCcXl06nPd+chFEikWY5Yp66P5vjktYMxr77VgXV8ZiFykvChD8/fGxic7uFrU+HeL+1j4jGQ/Kw2EbCtgadNsKJ7y473S/Be4dMwlrmLnUaw3D9J1W3Q2gwaTzJAAAAAElFTkSuQmCC')\",\n            \"backgroundSize\": \"cover\",\n            \"display\": \"block\"\n          }\n        }}></span>{`\n  `}<img parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-image\",\n          \"alt\": \"1\",\n          \"title\": \"1\",\n          \"src\": \"/vaccine-solution-main/static/439b6762241317eea278cb1af538286b/3cbba/reefer-simul-1.png\",\n          \"srcSet\": [\"/vaccine-solution-main/static/439b6762241317eea278cb1af538286b/7fc1e/reefer-simul-1.png 288w\", \"/vaccine-solution-main/static/439b6762241317eea278cb1af538286b/a5df1/reefer-simul-1.png 576w\", \"/vaccine-solution-main/static/439b6762241317eea278cb1af538286b/3cbba/reefer-simul-1.png 1152w\", \"/vaccine-solution-main/static/439b6762241317eea278cb1af538286b/2b250/reefer-simul-1.png 1284w\"],\n          \"sizes\": \"(max-width: 1152px) 100vw, 1152px\",\n          \"style\": {\n            \"width\": \"100%\",\n            \"height\": \"100%\",\n            \"margin\": \"0\",\n            \"verticalAlign\": \"middle\",\n            \"position\": \"absolute\",\n            \"top\": \"0\",\n            \"left\": \"0\"\n          },\n          \"loading\": \"lazy\"\n        }}></img>{`\n    `}</span></p>\n    <p>{`The simulator needs to integrate with Kafka deployed as service on the cloud or deployed within an OpenShift cluster. For deployment we are proposing to use Event Streams with Cloud Pak for Integration or `}<a parentName=\"p\" {...{\n        \"href\": \"https://strimzi.io\"\n      }}>{`Strimzi`}</a>{` / Redhat AMQ Streams. The `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/ibm-cloud-architecture/vaccine-gitops\"\n      }}>{`gitops project`}</a>{` includes yaml files to deploy event streams or kafka cluster using Strimzi operators.`}</p>\n    <h2>{`Anatomy`}</h2>\n    <p>{`The simulator expose one POST operation on the `}<inlineCode parentName=\"p\">{`/control`}</inlineCode>{` URL, as you can see from the Swagger UI (`}<inlineCode parentName=\"p\">{`/openapi`}</inlineCode>{`)`}</p>\n    <span {...{\n      \"className\": \"gatsby-resp-image-wrapper\",\n      \"style\": {\n        \"position\": \"relative\",\n        \"display\": \"block\",\n        \"marginLeft\": \"auto\",\n        \"marginRight\": \"auto\",\n        \"maxWidth\": \"1152px\"\n      }\n    }}>{`\n      `}<span parentName=\"span\" {...{\n        \"className\": \"gatsby-resp-image-background-image\",\n        \"style\": {\n          \"paddingBottom\": \"28.819444444444443%\",\n          \"position\": \"relative\",\n          \"bottom\": \"0\",\n          \"left\": \"0\",\n          \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAABCklEQVQY033RO0rEQByA8dxIPMBKwE5RUKwED2Bj5QnsXBSW9bWKheApLMVOLIQtFERw17yTnSSTly6Ln5O4ARVN8WOmmP83DKPdOk84IsAIPQxR87/tPV4VNxEEhSTI418kfhZhhj6OOqO5MkSOc+L37IcwT4je0kpYJIi8JP+QMEpjBq6NJ1VwGFg4qcCasqfrs2diyAAnj4g+ChLGjXImiEmGZqkhVw1VshCviLGSEb2LS9qdQzonZ7S7R432Do7Z2d3n6uZaPVmFHBWqlUEj8tnc2mZ1bYPllXXm9EVa+sK/9PklZmZbdE/P0cqIW8W+wvUF948P3PX7vNgGA99mqD6tkXAx5YhPV+adlsKgtqsAAAAASUVORK5CYII=')\",\n          \"backgroundSize\": \"cover\",\n          \"display\": \"block\"\n        }\n      }}></span>{`\n  `}<img parentName=\"span\" {...{\n        \"className\": \"gatsby-resp-image-image\",\n        \"alt\": \"1\",\n        \"title\": \"1\",\n        \"src\": \"/vaccine-solution-main/static/df4bf1fa6d1cab5aeaea4644b9bd6fd1/3cbba/simulapp-control-swagger.png\",\n        \"srcSet\": [\"/vaccine-solution-main/static/df4bf1fa6d1cab5aeaea4644b9bd6fd1/7fc1e/simulapp-control-swagger.png 288w\", \"/vaccine-solution-main/static/df4bf1fa6d1cab5aeaea4644b9bd6fd1/a5df1/simulapp-control-swagger.png 576w\", \"/vaccine-solution-main/static/df4bf1fa6d1cab5aeaea4644b9bd6fd1/3cbba/simulapp-control-swagger.png 1152w\", \"/vaccine-solution-main/static/df4bf1fa6d1cab5aeaea4644b9bd6fd1/0b124/simulapp-control-swagger.png 1728w\", \"/vaccine-solution-main/static/df4bf1fa6d1cab5aeaea4644b9bd6fd1/4ea69/simulapp-control-swagger.png 2304w\", \"/vaccine-solution-main/static/df4bf1fa6d1cab5aeaea4644b9bd6fd1/07adc/simulapp-control-swagger.png 2788w\"],\n        \"sizes\": \"(max-width: 1152px) 100vw, 1152px\",\n        \"style\": {\n          \"width\": \"100%\",\n          \"height\": \"100%\",\n          \"margin\": \"0\",\n          \"verticalAlign\": \"middle\",\n          \"position\": \"absolute\",\n          \"top\": \"0\",\n          \"left\": \"0\"\n        },\n        \"loading\": \"lazy\"\n      }}></img>{`\n    `}</span>\n    <p>{` The Json control object defines the number records to produce, the sensor to impact (co2sensor, temperature, o2sensor, power) , the container ID, (one of C01, C02, C03, C04) which carries the product referenced by product_id (one of P01, P02, P03, P04, P05, covid-19) - The P01 is the covid-19 vaccine:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-json\"\n      }}>{`    { 'containerID': 'C02',\n    'simulation': 'tempGrowth',\n    'nb_of_records': 100,\n    \"product_id\":  \"covid-19\"\n    }\n`}</code></pre>\n    <p>{`We have tried to support a domain driven design approach to structure the code, with domain, infrastructure and app modules. The domain module has a unique class for the simulator which main goal is to generate data tuples or records for the different simulation types. It is reused by the standalone simulation CLI tool to generate csv data.`}</p>\n    <p>{`As the simulator is also a webapp we need to package it with `}<a parentName=\"p\" {...{\n        \"href\": \"https://www.fullstackpython.com/flask.html\"\n      }}>{`Flask`}</a>{` and run it using one of the Web Server Gateway Interface (WSGI) implementation, like `}<a parentName=\"p\" {...{\n        \"href\": \"http://docs.gunicorn.org/\"\n      }}>{`Gunicorn`}</a>{`.`}</p>\n    <p>{`If you want to go over the code, we recommend to follow `}<a parentName=\"p\" {...{\n        \"href\": \"https://flask.palletsprojects.com/en/1.1.x/tutorial/\"\n      }}>{`Flask tutorial`}</a>{`.`}</p>\n    <p>{`Flask is a simple library to implement REST based microservice and web application in Python. It has other related projects to add interesting features to develop production ready application. The standard development includes defining routes, function to support handling the request and generating HTTP response, but also defining APIs… Read more with the `}<a parentName=\"p\" {...{\n        \"href\": \"http://exploreflask.com/en/latest/\"\n      }}>{`explore Flask book online`}</a>{`.`}</p>\n    <p>{`Flask is mono threaded so it fits well in a simple web application for development purpose, but for production it is recommended to add a web server like `}<a parentName=\"p\" {...{\n        \"href\": \"https://gunicorn.org/\"\n      }}>{`Gunicorn`}</a>{` to handle multiple concurrent requests.`}</p>\n    <p>{`The app is also using Flask blueprint, flasgger, flask_restful, prometheus, confluent_kafka.`}</p>\n    <p>{`The app.py Flask application imports the different blue prints, serves the Vuejs app, serves the apidoc and starts the server. Each `}<a parentName=\"p\" {...{\n        \"href\": \"https://flask.palletsprojects.com/en/1.1.x/blueprints/\"\n      }}>{`Flask blueprints`}</a>{` is defined in the `}<inlineCode parentName=\"p\">{`api`}</inlineCode>{` folder. `}</p>\n    <p>{`The basic concept of blueprints is that, they record operations to execute when each operation is registered on an application. So to add one operation to support a `}<inlineCode parentName=\"p\">{`/control`}</inlineCode>{` resource, we add a blueprint, and then register it in the main application: `}<inlineCode parentName=\"p\">{`app.py`}</inlineCode>{`.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-python\"\n      }}>{`from api.controller import control_blueprint\napp.register_blueprint(control_blueprint)\n`}</code></pre>\n    <p>{`To define the API, we use `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/flasgger/flasgger\"\n      }}>{`Flasgger`}</a>{` as an extension to Flask to extract `}<a parentName=\"p\" {...{\n        \"href\": \"https://swagger.io/docs/specification/about/\"\n      }}>{`Open API specification`}</a>{` from the code. It comes with Swagger UI, so we can see the API documentation of the microservice at the URL `}<inlineCode parentName=\"p\">{`/apidocs`}</inlineCode>{`.  It can also validate the data according to the schema defined.`}</p>\n    <p>{`For the POST `}<inlineCode parentName=\"p\">{`/control`}</inlineCode>{` we defined the Swagger 2.0 API in a separate file: `}<inlineCode parentName=\"p\">{`api/controlapi.yml`}</inlineCode>{` and import it at the method level to support the POST operation. This method is defined in its blueprint as a REST resource. The code `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/ibm-cloud-architecture/vaccine-reefer-simulator/blob/master/simulator/api/controller.py\"\n      }}>{`controller.py`}</a>{` is under `}<inlineCode parentName=\"p\">{`api`}</inlineCode>{` folder.`}</p>\n    <p>{`Below is a code extract to illustrate the use of Flask-RESTful and blueprint and the swagger annotation:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-python\"\n      }}>{`from flasgger import swag_from\nfrom flask_restful import Resource, Api\n\ncontrol_blueprint = Blueprint(\"control\", __name__)\napi = Api(control_blueprint)\n\nclass SimulationController(Resource):\n    @swag_from('controlapi.yml')\n    def post(self):\n        # ..\napi.add_resource(SimulationController, \"/control\")\n`}</code></pre>\n    <p>{`The `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/ibm-cloud-architecture/vaccine-reefer-simulator/blob/master/Pipfile\"\n      }}>{`Pipfile`}</a>{` defines the dependencies for this component, and is used by `}<inlineCode parentName=\"p\">{`pipenv`}</inlineCode>{` during the docker build process.`}</p>\n    <p><strong parentName=\"p\">{`Github repository:`}</strong>{` `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/ibm-cloud-architecture/vaccine-reefer-simulator\"\n      }}>{`vaccine-reefer-simulator`}</a></p>\n    <p><strong parentName=\"p\">{`Kafka topics produced to:`}</strong>{` telemetries`}</p>\n    <p><strong parentName=\"p\">{`Event sents to the topic:`}</strong></p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-python\"\n      }}>{`{\"containerID\": metric[0],\n\"timestamp\": str(metric[1]),\n\"type\":\"ReeferTelemetries\",\n\"payload\"={ \"timestamp\": \"2019-09-04 T15:31 Z\",\n            \"containerID\": \"C101\",\n            \"product_id\": \"P02\",\n            \"sensors\": {\n              \"temperature\": 2.49647,\n              \"oxygen_level\" : 20.4543,\n              \"nitrogen_level\" : 79.4046,\n              \"carbon_dioxide_level\" : 4.42579,\n              \"humidity_level\" : 60.3148,\n              \"fan_1\": \"True\",\n              \"fan_2\" : \"True\",\n              \"fan_3\" : \"True\",\n              \"ambiant_temperature\": 19.8447\n            },\n            \"content_type\": 1,\n            \"target_temperature\": 6.0,\n            \"kilowatts\": 3.44686,\n            \"latitude\": \"37.8226902168957,\",\n            \"longitude\": \"-122.3248956640928\",\n            \"time_door_open\" : 300,\n            \"defrost_cycle\": 6\n        }\n}\n`}</code></pre>\n    <h2>{`Build`}</h2>\n    <p>{`This microservice is built using the docker:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-shell\"\n      }}>{`docker build -t quay.io/ibmcase/vaccine-reefer-simulator .\ndocker push quay.io/ibmcase/vaccine-reefer-simulator\n`}</code></pre>\n    <h2>{`Run`}</h2>\n    <h3>{`Run locally with docker-compose`}</h3>\n    <p>{`See the `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/ibm-cloud-architecture/vaccine-reefer-simulator#run-locally\"\n      }}>{`readme in the repository`}</a>{` to execute the python app within a Dockerfile and remote connected to Evenstreams on OpenShift.`}</p>\n    <h3>{`Deployment to OpenShift`}</h3>\n    <p>{`We have moved the description on how to deploy this app to OpenShift in the `}<a parentName=\"p\" {...{\n        \"href\": \"/vaccine-solution-main/use-cases/cold-chain/#deploy-the-vaccine-reefer-simulator\"\n      }}>{`cold chain scenario`}</a>{`. `}</p>\n    <h2>{`Demonstrate`}</h2>\n    <p>{`Once deployed, you can access the user interface and select one existing container, then`}</p>\n    <p>{`Enter the product to be used P01 for covid-19\nThe number of records to send ( less than 500, 100 should be fine)\nThe simulation type: For cold chain monitoring use case, select the `}<inlineCode parentName=\"p\">{`tempGrowth`}</inlineCode>{` simulation. After few second the gauge should display the generated telemetries. When the simulator is integrated with all the cold chain component, it will also display the Alerts created.`}</p>\n    <p>{`As an alternate is to access the OpenAPI docs user interface:`}</p>\n    <ol>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`To determine the route, use the `}<inlineCode parentName=\"p\">{`oc get route reefer-simulator`}</inlineCode>{` command and go to the URL specified in the `}<inlineCode parentName=\"p\">{`HOST/PORT/apidocs`}</inlineCode>{` field in your browser.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`From there, drill down into the `}<inlineCode parentName=\"p\">{`POST /control`}</inlineCode>{` section and click `}<strong parentName=\"p\">{`Try it out!`}</strong>{`.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Enter any of the following options for the fields prepopulated in the `}<inlineCode parentName=\"p\">{`control`}</inlineCode>{` body: P01 is the covid-19 vaccine.`}</p>\n        <ul parentName=\"li\">\n          <li parentName=\"ul\">{`Container: `}<inlineCode parentName=\"li\">{`C01, C02, C03, C04`}</inlineCode></li>\n          <li parentName=\"ul\">{`Product: `}<inlineCode parentName=\"li\">{`P01, P02, P03, P04`}</inlineCode></li>\n          <li parentName=\"ul\">{`Simulation: `}<inlineCode parentName=\"li\">{`tempGrowth`}</inlineCode></li>\n          <li parentName=\"ul\">{`Number of records: A positive integer`}</li>\n        </ul>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Click `}<strong parentName=\"p\">{`Execute`}</strong></p>\n      </li>\n    </ol>\n    <h2>{`More readings`}</h2>\n    <ul>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"https://flask-restful.readthedocs.io/en/latest/quickstart.html\"\n        }}>{`Flask Restful`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"https://appsody.dev/docs/using-appsody/building-and-deploying/\"\n        }}>{`Appsody build and deploy product documentation`}</a></li>\n    </ul>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"sourceRoot":""}