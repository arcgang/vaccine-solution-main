(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{PI8s:function(e,t,a){"use strict";a.r(t),a.d(t,"_frontmatter",(function(){return o})),a.d(t,"default",(function(){return s}));a("91GP"),a("rGqo"),a("yt8O"),a("Btvt"),a("RW0V"),a("q1tI");var n=a("7ljp"),r=a("013z");a("qKvR");function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var o={},c={_frontmatter:o},l=r.a;function s(e){var t=e.components,a=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,["components"]);return Object(n.b)(l,i({},c,a,{components:t,mdxType:"MDXLayout"}),Object(n.b)("p",null,"This note let you run the order management code with a simple scenario that addresses the following features:"),Object(n.b)("ul",null,Object(n.b)("li",{parentName:"ul"},"Create Order with a User interface"),Object(n.b)("li",{parentName:"ul"},"Validate the ",Object(n.b)("a",i({parentName:"li"},{href:"https://ibm-cloud-architecture.github.io/refarch-eda/patterns/intro/#transactional-outbox"}),"outbox pattern")," works to get OrderCreated, OrderUpdated or OrderCancelled Events to a dedicated table in postgres"),Object(n.b)("li",{parentName:"ul"},"Validate how ",Object(n.b)("a",i({parentName:"li"},{href:"https://debezium.io/documentation/reference/1.4/connectors/postgresql.html"}),"Debezium CDC")," for postgres as a Kafka connector, produces OrderEvents from the table to Kafka."),Object(n.b)("li",{parentName:"ul"},"Integrate with the Shipment plan optimization")),Object(n.b)("h2",null,"Components involved in this demonstration"),Object(n.b)("ul",null,Object(n.b)("li",{parentName:"ul"},Object(n.b)("p",{parentName:"li"},"Vaccine Order Service")),Object(n.b)("li",{parentName:"ul"},Object(n.b)("p",{parentName:"li"},"Postgres DB")),Object(n.b)("li",{parentName:"ul"},Object(n.b)("p",{parentName:"li"},"Debezium for change data capture on the outbox table")),Object(n.b)("li",{parentName:"ul"},Object(n.b)("p",{parentName:"li"},"Kafka ")),Object(n.b)("li",{parentName:"ul"},Object(n.b)("p",{parentName:"li"},"Vaccine Order Reefer Optimization Service"),Object(n.b)("span",i({parentName:"li"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"777px"}}),"\n      ",Object(n.b)("span",i({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"54.861111111111114%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAACbElEQVQoz2VTS2vUUBTOzj+gO0Hc+wNcuBEENy5cunAngg9ciS6KoCJCEVQqFmlLKa4sVsq0dawbhVYdsdqpTKf0NbXOq5m088jkJrlJ7r35PPd2Kog3fMnNeXw59zsnlgoC+G0PrNndR8uD4iHSmP8DxBHSiEOSD0mE0GMYf/sNoxOfMDb5BaOv59F0WrBCl2FsZAnDgz8w8mIRo0OLcBwGlabgXBCPQKQRJwYsIEJatYaL4+f7cfLSIE5fG8ahU31YLGzBClwPM1NFTE8WkM0sY3amiE47oJQUSSKglIJIJLodz7xrpGTrdAPcePTG4NZABhfvvESlYsOCjChZUZCkSmJIemoIISAl2ekSUoKHCdkkEUr6Vgp7t4sTFx7jyNn7OHruIQ6fuYv1zSqspVUHma8NuJRwsDhpFUcRFBFqYlNlLAxxkiSmgI4X4PbAFPqez+De0DtcfvAK9ZoD6+qzPI5dmcfc8h6cvTYqdtvotF3fRWWnSdUKtLqMfK4hWtmqodzwaC/x36JmWdlcFU+zZRS3m7jeP4GbT6aw/ruO8Y/f8SG/ZuKmcwW8X1gxexZJAgmRUrVSmOZpSKpe0clIw7hHrxDygI4n4DTbyH7Oo1Aqww8Y5hZ+IrdEzXJdQ6RjE5EYrbXGhlT1CCWn2dLCk05+RKNBwnt0ZJf5qNsNrG5sktglVOs7YCHNH42OBuMxVdgj1PdUmTm1FPOQJtRdeuF+CE5kMSVyP4BNJI26jdJGCeurawhZgCjkiChGx+qclAZe6aHXP0Pgw0q9rtkcQPkazIDmyNjsX1toVis9/77vb/xBri6M7H8ACQ8nDVgeUpYAAAAASUVORK5CYII=')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(n.b)("img",i({parentName:"span"},{className:"gatsby-resp-image-image",alt:"vaccine order 1",title:"vaccine order 1",src:"/vaccine-solution-main/static/f687ca251b28950f8caa6b410572107d/c53c3/vaccine-order-1.png",srcSet:["/vaccine-solution-main/static/f687ca251b28950f8caa6b410572107d/7fc1e/vaccine-order-1.png 288w","/vaccine-solution-main/static/f687ca251b28950f8caa6b410572107d/a5df1/vaccine-order-1.png 576w","/vaccine-solution-main/static/f687ca251b28950f8caa6b410572107d/c53c3/vaccine-order-1.png 777w"],sizes:"(max-width: 777px) 100vw, 777px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    "))),Object(n.b)("p",null,"To have a deeper understanding of the order service read ",Object(n.b)("a",i({parentName:"p"},{href:"/vaccine-solution-main/solution/orderms/#overview"}),"this overview section"),". For the Vaccine order reefer optimization service ",Object(n.b)("a",i({parentName:"p"},{href:"/vaccine-solution-main/design/voro/"}),"the design article")," details the optimization approach, while the ",Object(n.b)("a",i({parentName:"p"},{href:"/vaccine-solution-main/solution/orderms/voro-solution/#overview"}),"solution article")," goes over the service implementation details."),Object(n.b)("h2",null,"Deploy to OpenShift"),Object(n.b)("h3",null,"Pre-requisites"),Object(n.b)("ul",null,Object(n.b)("li",{parentName:"ul"},Object(n.b)("p",{parentName:"li"},"You need:"),Object(n.b)("ul",{parentName:"li"},Object(n.b)("li",{parentName:"ul"},"docker and docker compose on your laptop to run locally or build image"),Object(n.b)("li",{parentName:"ul"},"Java 11"),Object(n.b)("li",{parentName:"ul"},"git client "),Object(n.b)("li",{parentName:"ul"},"Get access to an OpenShift cluster with Cloud Pak for integration and event streams installed."),Object(n.b)("li",{parentName:"ul"},"Have a TLS user and a SCRAM user created in the event streams OpenShift project. See ",Object(n.b)("a",i({parentName:"li"},{href:"https://ibm-cloud-architecture.github.io/refarch-eda/use-cases/overview/pre-requisites/#generate-scram-service-credentials"}),"this note")," if needed."))),Object(n.b)("li",{parentName:"ul"},Object(n.b)("p",{parentName:"li"},"Clone the two main projects:"),Object(n.b)("pre",{parentName:"li"},Object(n.b)("code",i({parentName:"pre"},{className:"language-shell"}),"git clone https://github.com/ibm-cloud-architecture/vaccine-order-mgr-pg\ngit clone https://github.com/ibm-cloud-architecture/vaccine-order-optimization-pg\n")))),Object(n.b)("h3",null,"Deploy the Vaccine Order Service"),Object(n.b)("p",null,"This microservice is built using maven and Quarkus extensions. We have already pushed the last version of this service on dockerhub, if you do not want to build it. "),Object(n.b)("ul",null,Object(n.b)("li",{parentName:"ul"},Object(n.b)("p",{parentName:"li"},"Deploy a postgres server. The orders are persisted in an external Postgres instance running on Openshift cluster. To do a simple deployment performs the following commands:"),Object(n.b)("pre",{parentName:"li"},Object(n.b)("code",i({parentName:"pre"},{className:"language-shell"}),'# Define environement variables\nSERVICE_ACCOUNT_NAME=postgres-sa\nDEPLOYMENT_NAME=postgres\nSERVICE_NAME=postgres\nDOCKER_IMAGE=docker.io/postgres:11.6-alpine\nPOSTGRES_PASSWORD=adifficultpasswordtoguess\n\noc create serviceaccount ${SERVICE_ACCOUNT_NAME}\noc adm policy add-scc-to-user anyuid -n ${PROJECT_NAME} -z ${SERVICE_ACCOUNT_NAME}\noc create deployment ${DEPLOYMENT_NAME} --image=${DOCKER_IMAGE}\noc set serviceaccount deployment/${DEPLOYMENT_NAME} ${SERVICE_ACCOUNT_NAME}\noc patch deployment ${DEPLOYMENT_NAME} --type="json" -p=\'[{"op":"add", "path":"/spec/template/spec/containers/0/args", "value":[]},{"op":"add", "path":"/spec/template/spec/containers/0/args/-", "value":"-c"},{"op":"add", "path":"/spec/template/spec/containers/0/args/-", "value":"wal_level=logical"} ]\'\noc set env deployment ${DEPLOYMENT_NAME} POSTGRES_PASSWORD=${POSTGRES_PASSWORD}\noc expose deployment ${DEPLOYMENT_NAME} --port 5432 --name ${SERVICE_NAME}\n'))),Object(n.b)("li",{parentName:"ul"},Object(n.b)("p",{parentName:"li"},"Get an instance of Kafka deployed on OpenShift like ",Object(n.b)("a",i({parentName:"p"},{href:"https://ibm-cloud-architecture.github.io/refarch-eda/use-cases/overview/pre-requisites#install-event-streams-using-operators"}),"IBM Event Streams"),"â€¦). "))),Object(n.b)("h3",null,"Deploy the Optimization Service"),Object(n.b)("h2",null,"Scenario script"),Object(n.b)("p",null,"Once the solution is up and running in your target deployment environment (local or OpenShift) execute the following steps to present an end to end demonstration."),Object(n.b)("h3",null,"Validate existing vaccine lot shipment plan"),Object(n.b)("h3",null,"Create an order from the user interface of the Order Service."),Object(n.b)("h3",null,"See how the shipment plan is modified"),Object(n.b)("h3",null,"Validate the blockchain records"),Object(n.b)("h3",null,"Present the events created"))}s.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-use-cases-order-index-mdx-d578a886e96e88bb3dc9.js.map